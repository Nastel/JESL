<?xml version="1.0" encoding="utf-8" standalone="yes"?>

<!-- 
These sets are required to demo this simulation. Run as an upsert in Query Browser.

upsert set name = "RiskLoosingCustomer", learnquery = "Get Event Fields tokenize(message,' ') where name='SQL.cancel.account'", classifier="CustomerSatisfaction"
upsert BayesSourceFields active=true, name='msgItems', jkqlexpr='tokenize(msg," ")'
upsert dictionary properties=('classifier'='msgItems'), name='RiskLoosingCustomer'	
 -->


<tnt4j-simulator> 
 
<source id="1" fqn="APPL=CancelAccount#SERVER=ProcessAccountServer#NETADDR=162.123.74.18#DATACENTER=DC2#GEOADDR=34.05223,-118.24368" user="system"/>
<source id="2" fqn="APPL=NotateAccount#SERVER=ProcessAccountServer#NETADDR=162.123.74.18#DATACENTER=DC2#GEOADDR=34.05223,-118.24368" user="system"/>

<var name="sleep" value="50000 bet 300000"/>
<var name="elapsedTime" value="50000 bet 300000"/>

<var name="acct1" value="10000000 bet 99999999"/>
<var name="acct2" value="1000 bet 9999"/>
<var name="acct3" value="1000 bet 9999"/>
<var name="acct4" value="1000 bet 9999"/>
<var name="acct5" value="100000000000 bet 999999999999"/>   

<msg id="1">Credit was not issued. Customer is frustrated.</msg>
<msg id="2">Shipment was not received. Tracking item, will call back.</msg>
<msg id="3">Item was damaged. Return receipt sent out.</msg>
<msg id="4">Credit card was charged twice.</msg>
<msg id="5">Asked to speak with supervisor.</msg>
<msg id="6">Wrong size sent.</msg>
<msg id="7">Wrong color sent.</msg>
<msg id="8">Customer had to correct a wrong address that was specified when shipping information was entered.</msg>


<var name="msgNum" value="1 bet 8"/>

  <activity name="CancelAccount" source="1" >
    <event name="SQL.retrieve.account" type="CALL" elapsed="${elapsedTime}" sev="TRACE" res="jdbc://oracle/ora1/order_db">
    	<prop name="accountId" type="STRING" value="${acct1}-${acct2}-${acct3}-${acct4}-${acct5}"/>
    </event>
	<event name="SQL.cancel.account" type="CALL" elapsed="${elapsedTime}" sev="TRACE" res="jdbc://oracle/ora1/order_db" msg="${msgNum}">
	 	<prop name="query" type="STRING" value="update account set status='X' where account='${acct1}-${acct2}-${acct3}-${acct4}-${acct5}'"/>
	</event>
    <sleep usec="121"/>
  </activity>
  
    
</tnt4j-simulator>